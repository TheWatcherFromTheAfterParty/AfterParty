<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PHASE 2</title>
    <link rel="stylesheet" href="style.css">
    <script>
        function checkPassword() {
            var password = document.getElementById("password").value;
            password = password.toLowerCase().replace(/\s/g, "");
            if (password === "braised") { 
                document.body.innerHTML = "<h1 class='glitch'>PASSWORD ENTERED...</h1><p>Decrypting...</p>";
                setTimeout(function() {
                    localStorage.setItem("progress", "anagram");
                    window.location.href = "anagram.html"; 
                }, 3000); // Simulate hacking delay
            } else {
                document.body.innerHTML = "<h1 class='glitch'>PASSWORD ENTERED...</h1><p>Decrypting...</p>";
                setTimeout(function() {
                    document.body.innerHTML = "<h1 class='glitch'>ACCESS DENIED</h1><p>Restarting...</p>";
                    setTimeout(function() {
                        location.reload();
                    }, 3000); // Reload delay after joke
                }, 3000); // Fake self-destruct delay
            }
        }

        function checkProgress() {
            var progress = localStorage.getItem("progress");
            if (progress === "cipher") {
                window.location.href = "cipher.html";
            }
            
        }

        function startTyping() {
            if (!localStorage.getItem("anagramTypingDone")) {
                // First visit: Run the typewriter animation with delays
                setTimeout(() => document.getElementById("hiddenMessage1").style.display = "block", 4000);
                setTimeout(() => document.getElementById("hiddenMessage2").style.display = "block", 8000);
                setTimeout(() => document.getElementById("hiddenMessage3").style.display = "block", 12000);
                setTimeout(() => document.getElementById("hiddenMessage4").style.display = "block", 16000);
                setTimeout(() => document.getElementById("hiddenMessage5").style.display = "block", 20000);
                // setTimeout(() => document.getElementById("hiddenMessage6").style.display = "block", 24000);
                // setTimeout(() => document.getElementById("hiddenMessage7").style.display = "block", 28000);

                // Mark as played
                localStorage.setItem("anagramTypingDone", "true");
            } else {
                // Subsequent visits: Instantly reveal all text without animation
                for (let i = 0; i <= 5; i++) {
                    let message = document.getElementById(`hiddenMessage${i}`);
                    message.style.display = "block";
                    message.style.animation = "none"; // Remove typewriter effect
                    message.style.borderRight = "none"; // Hide cursor effect
                }
            }
        }

</script>
</head>

<body onload="checkProgress(); startTyping();">
<h1 class="glitch">PHASE 2</h1>
<p></p>
<div class="typewriter">
    <p id="hiddenMessage0" style="animation-delay: 0s; display: none;">XWK FYXDWKA PKMJP XWKQA AKCYAJP</p>
    <p id="hiddenMessage1" style="animation-delay: 0s; display: none;">VUBBUF XWK PQCMYB</p>
    <p id="hiddenMessage2" style="animation-delay: 0s; display: none;">XWK XQTK JAYFP MKYA</p>
    <p id="hiddenMessage3" style="animation-delay: 0s; display: none;">VQMYBXAYMPTQPPQUM WXTB</p>
</div>

</body>
</html>